{
  "hash": "4b1e76c42af94da674cee2c327f59048",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Module Technique 1 ‚Äî Introduction √† Docker\"\nsubtitle: \"Conteneuriser tes applications pour les rendre portables et reproductibles\"\nauthor: \"Fran√ßois Boussengui\"\ndate: last-modified\ncategories: [docker, mlops, technique]\ntitle-block-banner: \"#06436e\"\ntitle-block-banner-color: \"rgb(251, 225, 174)\"\ntoc: true\ntoc-depth: 3\nnumber-sections: true\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n```{=html}\n<style>\n.objectifs-box {\n    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n    border-left: 4px solid #06436e;\n    padding: 1.5rem;\n    border-radius: 0 12px 12px 0;\n    margin: 1.5rem 0;\n}\n\n.objectifs-box h3 {\n    color: #06436e;\n    margin-top: 0;\n}\n\n.concept-cle {\n    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n    border-left: 4px solid #72f1b8;\n    padding: 1.25rem;\n    border-radius: 0 10px 10px 0;\n    margin: 1.5rem 0;\n}\n\n.attention-box {\n    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n    border-left: 4px solid #fe4454;\n    padding: 1.25rem;\n    border-radius: 0 10px 10px 0;\n    margin: 1.5rem 0;\n}\n\n.exemple-box {\n    background: linear-gradient(135deg, #fef9e6 0%, #fef3c7 100%);\n    border-left: 4px solid #f8d65c;\n    padding: 1.25rem;\n    border-radius: 0 10px 10px 0;\n    margin: 1.5rem 0;\n}\n\n.terminal-box {\n    background: #1e293b;\n    color: #e2e8f0;\n    padding: 1rem 1.25rem;\n    border-radius: 8px;\n    font-family: 'Fira Code', monospace;\n    margin: 1rem 0;\n    overflow-x: auto;\n}\n\n.terminal-box .prompt {\n    color: #72f1b8;\n}\n\n.terminal-box .comment {\n    color: #64748b;\n}\n\n.terminal-box .output {\n    color: #f8d65c;\n}\n\n.comparison-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 1.5rem;\n    margin: 1.5rem 0;\n}\n\n.comparison-card {\n    background: white;\n    border-radius: 12px;\n    padding: 1.5rem;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n}\n\n.comparison-card h4 {\n    margin-top: 0;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.prerequis-temps {\n    display: flex;\n    gap: 2rem;\n    flex-wrap: wrap;\n    margin: 1rem 0;\n}\n\n.prerequis-temps > div {\n    background: #f1f5f9;\n    padding: 0.75rem 1.25rem;\n    border-radius: 8px;\n}\n\n.commande-table {\n    width: 100%;\n    border-collapse: collapse;\n    margin: 1rem 0;\n}\n\n.commande-table th {\n    background: #06436e;\n    color: white;\n    padding: 0.75rem;\n    text-align: left;\n}\n\n.commande-table td {\n    padding: 0.75rem;\n    border-bottom: 1px solid #e5e7eb;\n}\n\n.commande-table tr:nth-child(even) {\n    background: #f9fafb;\n}\n\n.commande-table code {\n    background: #e2e8f0;\n    padding: 0.2rem 0.4rem;\n    border-radius: 4px;\n    font-size: 0.9rem;\n}\n</style>\n```\n\n\n:::{.objectifs-box}\n### üéØ Objectifs d'apprentissage\n\n√Ä l'issue de ce module, tu seras capable de :\n\n1. **Expliquer** pourquoi Docker est essentiel en Data Science et MLOps\n2. **Distinguer** les concepts d'image, conteneur, volume et r√©seau\n3. **Installer** Docker sur ta machine (Windows, Mac ou Linux)\n4. **√âcrire** un Dockerfile basique pour une application Python\n5. **Utiliser** les commandes essentielles pour g√©rer tes conteneurs\n:::\n\n:::{.prerequis-temps}\n:::{div}\nüìö **Pr√©requis** : Notions de base en ligne de commande (terminal/bash)\n:::\n:::{div}\n‚è±Ô∏è **Temps estim√©** : 3 heures (installation incluse)\n:::\n:::\n\n---\n\n# Pourquoi Docker ?\n\n## Le probl√®me du \"√ßa marche sur ma machine\"\n\nTu as s√ªrement d√©j√† v√©cu cette situation : tu d√©veloppes un script Python, tout fonctionne parfaitement sur ton ordinateur, et quand tu le partages avec un coll√®gue ou que tu le d√©ploies en production... rien ne marche.\n\nLes causes possibles sont nombreuses :\n\n- Versions de Python diff√©rentes (3.8 vs 3.11)\n- Packages manquants ou versions incompatibles\n- Variables d'environnement absentes\n- D√©pendances syst√®me (librairies C, drivers...)\n- Diff√©rences d'OS (Windows vs Linux)\n\n:::{.exemple-box}\n**üéØ Exemple concret**\n\nTu as d√©velopp√© un mod√®le de pr√©diction de sinistralit√© avec `scikit-learn 1.3`, `pandas 2.0` et `numpy 1.24`. Ton coll√®gue a des versions diff√©rentes ‚Üí le mod√®le crashe ou, pire, donne des r√©sultats diff√©rents silencieusement.\n:::\n\n## La solution Docker : tout empaqueter\n\nDocker r√©sout ce probl√®me en **empaquetant** ton application avec **tout son environnement** :\n\n\n```{mermaid}\n%%| fig-cap: \"Sans Docker vs Avec Docker\"\n\nflowchart LR\n    subgraph SANS[\"‚ùå Sans Docker\"]\n        A1[Ton code] --> B1[Machine 1<br>Python 3.8]\n        A1 --> C1[Machine 2<br>Python 3.11]\n        A1 --> D1[Serveur<br>Python ???]\n    end\n    \n    subgraph AVEC[\"‚úÖ Avec Docker\"]\n        A2[Ton code<br>+ Dockerfile] --> B2[Conteneur<br>Python 3.10]\n        B2 --> C2[Machine 1]\n        B2 --> D2[Machine 2]\n        B2 --> E2[Serveur]\n    end\n```\n\n\n:::{.concept-cle}\n**üí° Point cl√©**\n\nUn conteneur Docker embarque ton code **ET** son environnement complet. Il fonctionnera de fa√ßon identique sur n'importe quelle machine o√π Docker est install√©.\n:::\n\n## Docker vs Machines Virtuelles\n\nTu connais peut-√™tre les machines virtuelles (VM). Docker est diff√©rent et plus l√©ger :\n\n:::{.comparison-grid}\n\n:::{.comparison-card}\n#### üñ•Ô∏è Machine Virtuelle\n\n- Virtualise **tout le syst√®me** (OS complet)\n- D√©marre en **minutes**\n- Consomme **beaucoup de ressources** (RAM, disque)\n- Isolation **totale**\n- Taille : **plusieurs Go**\n:::\n\n:::{.comparison-card}\n#### üê≥ Conteneur Docker\n\n- Virtualise **seulement l'application**\n- D√©marre en **secondes**\n- Consomme **peu de ressources**\n- Partage le noyau de l'OS h√¥te\n- Taille : **quelques Mo √† centaines de Mo**\n:::\n\n:::\n\n\n```{mermaid}\n%%| fig-cap: \"Architecture VM vs Docker\"\n\nflowchart TB\n    subgraph VM[\"Machine Virtuelle\"]\n        direction TB\n        V1[App 1] --> VOS1[OS Guest 1]\n        V2[App 2] --> VOS2[OS Guest 2]\n        VOS1 --> HYP[Hyperviseur]\n        VOS2 --> HYP\n        HYP --> VH[Hardware]\n    end\n    \n    subgraph DOCKER[\"Conteneurs Docker\"]\n        direction TB\n        D1[App 1] --> DE[Docker Engine]\n        D2[App 2] --> DE\n        D3[App 3] --> DE\n        DE --> DOS[OS H√¥te]\n        DOS --> DH[Hardware]\n    end\n```\n\n\n---\n\n# Les concepts fondamentaux\n\n## Image vs Conteneur\n\nC'est LA distinction cruciale √† comprendre :\n\n| Concept | Analogie | Description |\n|---------|----------|-------------|\n| **Image** | Recette de cuisine | Template en lecture seule qui d√©finit l'environnement |\n| **Conteneur** | Plat cuisin√© | Instance en cours d'ex√©cution d'une image |\n\n:::{.exemple-box}\n**üç≥ Analogie culinaire**\n\n- L'**image** c'est la recette du g√¢teau : les ingr√©dients, les √©tapes, les quantit√©s\n- Le **conteneur** c'est le g√¢teau que tu as pr√©par√© √† partir de la recette\n- Tu peux faire **plusieurs g√¢teaux** (conteneurs) √† partir de **la m√™me recette** (image)\n:::\n\n\n```{mermaid}\n%%| fig-cap: \"Relation Image ‚Üí Conteneur\"\n\nflowchart LR\n    I[üñºÔ∏è Image<br>python:3.10] --> C1[üì¶ Conteneur 1<br>mon-app-dev]\n    I --> C2[üì¶ Conteneur 2<br>mon-app-test]\n    I --> C3[üì¶ Conteneur 3<br>mon-app-prod]\n```\n\n\n## Dockerfile : la recette\n\nLe **Dockerfile** est un fichier texte qui contient les instructions pour construire une image.\n\nVoici un exemple simple pour une application Python :\n\n```dockerfile\n# Image de base : Python 3.10 sur Linux l√©ger (Alpine)\nFROM python:3.10-slim\n\n# D√©finir le r√©pertoire de travail dans le conteneur\nWORKDIR /app\n\n# Copier le fichier des d√©pendances\nCOPY requirements.txt .\n\n# Installer les d√©pendances\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Copier le code de l'application\nCOPY . .\n\n# Commande par d√©faut au d√©marrage du conteneur\nCMD [\"python\", \"main.py\"]\n```\n\nChaque instruction cr√©e une **couche** (layer) dans l'image :\n\n\n```{mermaid}\n%%| fig-cap: \"Les couches d'une image Docker\"\n\nflowchart TB\n    L1[Layer 1: Image de base Python 3.10] --> L2\n    L2[Layer 2: WORKDIR /app] --> L3\n    L3[Layer 3: COPY requirements.txt] --> L4\n    L4[Layer 4: RUN pip install] --> L5\n    L5[Layer 5: COPY . .] --> L6\n    L6[Layer 6: CMD python main.py]\n    \n    style L1 fill:#06436e,color:#fff\n    style L4 fill:#f8d65c,color:#333\n    style L6 fill:#72f1b8,color:#333\n```\n\n\n:::{.concept-cle}\n**üí° Point cl√©**\n\nDocker **met en cache** les couches. Si tu modifies seulement ton code (pas les d√©pendances), seules les derni√®res couches seront reconstruites. C'est pourquoi on copie `requirements.txt` **avant** le code !\n:::\n\n## Volumes : persister les donn√©es\n\nPar d√©faut, les donn√©es dans un conteneur sont **√©ph√©m√®res** : elles disparaissent quand le conteneur s'arr√™te.\n\nLes **volumes** permettent de persister les donn√©es et de les partager entre le conteneur et ta machine :\n\n\n```{mermaid}\n%%| fig-cap: \"Volume Docker\"\n\nflowchart LR\n    subgraph HOST[\"üñ•Ô∏è Machine h√¥te\"]\n        H1[/home/user/data]\n    end\n    \n    subgraph CONTAINER[\"üì¶ Conteneur\"]\n        C1[/app/data]\n    end\n    \n    H1 <-->|Volume mont√©| C1\n```\n\n\n---\n\n# Installation de Docker\n\n## Sur Windows\n\n1. **Pr√©requis** : Windows 10/11 64-bit avec WSL2 activ√©\n\n2. **T√©l√©charger** Docker Desktop : [https://www.docker.com/products/docker-desktop](https://www.docker.com/products/docker-desktop)\n\n3. **Installer** en suivant l'assistant\n\n4. **V√©rifier** l'installation :\n\n:::{.terminal-box}\n<span class=\"prompt\">$</span> docker --version<br>\n<span class=\"output\">Docker version 24.0.7, build afdd53b</span><br><br>\n<span class=\"prompt\">$</span> docker run hello-world<br>\n<span class=\"output\">Hello from Docker!</span><br>\n<span class=\"output\">This message shows that your installation appears to be working correctly.</span>\n:::\n\n## Sur macOS\n\n1. **T√©l√©charger** Docker Desktop pour Mac : [https://www.docker.com/products/docker-desktop](https://www.docker.com/products/docker-desktop)\n   - Choisir **Apple Silicon** (M1/M2/M3) ou **Intel** selon ton Mac\n\n2. **Installer** en glissant dans Applications\n\n3. **Lancer** Docker Desktop\n\n4. **V√©rifier** dans le terminal\n\n## Sur Linux (Ubuntu/Debian)\n\n:::{.terminal-box}\n<span class=\"comment\"># Mettre √† jour les packages</span><br>\n<span class=\"prompt\">$</span> sudo apt update<br><br>\n<span class=\"comment\"># Installer les pr√©requis</span><br>\n<span class=\"prompt\">$</span> sudo apt install ca-certificates curl gnupg<br><br>\n<span class=\"comment\"># Ajouter la cl√© GPG officielle de Docker</span><br>\n<span class=\"prompt\">$</span> sudo install -m 0755 -d /etc/apt/keyrings<br>\n<span class=\"prompt\">$</span> curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg<br><br>\n<span class=\"comment\"># Ajouter le repository</span><br>\n<span class=\"prompt\">$</span> echo \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null<br><br>\n<span class=\"comment\"># Installer Docker</span><br>\n<span class=\"prompt\">$</span> sudo apt update<br>\n<span class=\"prompt\">$</span> sudo apt install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin<br><br>\n<span class=\"comment\"># Permettre d'utiliser Docker sans sudo</span><br>\n<span class=\"prompt\">$</span> sudo usermod -aG docker $USER<br>\n<span class=\"comment\"># Puis d√©connecte-toi et reconnecte-toi</span>\n:::\n\n:::{.attention-box}\n**‚ö†Ô∏è Important**\n\nApr√®s l'installation sur Linux, n'oublie pas de te d√©connecter/reconnecter (ou red√©marrer) pour que les permissions Docker soient prises en compte.\n:::\n\n---\n\n# Les commandes essentielles\n\n## Cheat sheet\n\nVoici les commandes que tu utiliseras au quotidien :\n\n### Gestion des images\n\n| Commande | Description |\n|----------|-------------|\n| `docker build -t nom:tag .` | Construire une image depuis un Dockerfile |\n| `docker images` | Lister les images locales |\n| `docker pull nom:tag` | T√©l√©charger une image depuis Docker Hub |\n| `docker rmi nom:tag` | Supprimer une image |\n\n### Gestion des conteneurs\n\n| Commande | Description |\n|----------|-------------|\n| `docker run nom:tag` | Cr√©er et d√©marrer un conteneur |\n| `docker run -it nom:tag bash` | D√©marrer en mode interactif |\n| `docker run -d nom:tag` | D√©marrer en arri√®re-plan (detached) |\n| `docker ps` | Lister les conteneurs en cours |\n| `docker ps -a` | Lister tous les conteneurs (y compris arr√™t√©s) |\n| `docker stop id` | Arr√™ter un conteneur |\n| `docker rm id` | Supprimer un conteneur |\n| `docker logs id` | Voir les logs d'un conteneur |\n| `docker exec -it id bash` | Entrer dans un conteneur en cours |\n\n### Options utiles de `docker run`\n\n| Option | Description |\n|--------|-------------|\n| `-p 8080:80` | Mapper le port 80 du conteneur au port 8080 de l'h√¥te |\n| `-v /host/path:/container/path` | Monter un volume |\n| `-e VAR=value` | D√©finir une variable d'environnement |\n| `--name mon-conteneur` | Donner un nom au conteneur |\n| `--rm` | Supprimer le conteneur automatiquement √† l'arr√™t |\n\n## Exemples pratiques\n\n### Lancer un conteneur Python interactif\n\n:::{.terminal-box}\n<span class=\"prompt\">$</span> docker run -it python:3.10 python<br>\n<span class=\"output\">Python 3.10.13 (main, Nov 15 2023, 03:40:21)</span><br>\n<span class=\"output\">>>> print(\"Hello depuis Docker!\")</span><br>\n<span class=\"output\">Hello depuis Docker!</span><br>\n<span class=\"output\">>>> exit()</span>\n:::\n\n### Construire et lancer ta propre image\n\n:::{.terminal-box}\n<span class=\"comment\"># Se placer dans le dossier contenant le Dockerfile</span><br>\n<span class=\"prompt\">$</span> cd mon-projet<br><br>\n<span class=\"comment\"># Construire l'image (le point = contexte courant)</span><br>\n<span class=\"prompt\">$</span> docker build -t mon-app:v1 .<br><br>\n<span class=\"comment\"># Lancer un conteneur</span><br>\n<span class=\"prompt\">$</span> docker run --rm mon-app:v1<br><br>\n<span class=\"comment\"># Lancer avec un volume pour le d√©veloppement</span><br>\n<span class=\"prompt\">$</span> docker run --rm -v $(pwd):/app mon-app:v1\n:::\n\n---\n\n# Ton premier Dockerfile Data Science\n\n## Structure du projet\n\nCr√©ons un projet simple qui calcule des indicateurs de sinistralit√© :\n\n```\nmon-projet/\n‚îú‚îÄ‚îÄ Dockerfile\n‚îú‚îÄ‚îÄ requirements.txt\n‚îú‚îÄ‚îÄ main.py\n‚îî‚îÄ‚îÄ data/\n    ‚îî‚îÄ‚îÄ sinistres.csv\n```\n\n## Le fichier requirements.txt\n\n```text\npandas==2.0.3\nnumpy==1.24.3\nmatplotlib==3.7.2\n```\n\n## Le script main.py\n\n```python\n\"\"\"\nCalcul d'indicateurs de sinistralit√©\nPremier script dockeris√© !\n\"\"\"\nimport pandas as pd\nimport numpy as np\n\ndef calculer_indicateurs(df: pd.DataFrame) -> dict:\n    \"\"\"Calcule les indicateurs cl√©s de sinistralit√©.\"\"\"\n    \n    # Fr√©quence = nombre de sinistres / exposition\n    frequence = len(df) / df['exposition'].sum()\n    \n    # S√©v√©rit√© moyenne = co√ªt total / nombre de sinistres\n    severite = df['cout'].mean()\n    \n    # Prime pure = fr√©quence √ó s√©v√©rit√©\n    prime_pure = frequence * severite\n    \n    return {\n        'frequence': frequence,\n        'severite': severite,\n        'prime_pure': prime_pure,\n        'nb_sinistres': len(df),\n        'cout_total': df['cout'].sum()\n    }\n\ndef main():\n    print(\"=\" * 50)\n    print(\"üê≥ Script de sinistralit√© dockeris√©\")\n    print(\"=\" * 50)\n    \n    # Cr√©er des donn√©es d'exemple\n    np.random.seed(42)\n    n_sinistres = 1000\n    \n    df = pd.DataFrame({\n        'id_sinistre': range(n_sinistres),\n        'cout': np.random.lognormal(mean=7, sigma=1, size=n_sinistres),\n        'exposition': np.random.uniform(0.5, 1.0, size=n_sinistres)\n    })\n    \n    # Calculer les indicateurs\n    indicateurs = calculer_indicateurs(df)\n    \n    print(\"\\nüìä Indicateurs calcul√©s :\")\n    print(f\"   Nombre de sinistres : {indicateurs['nb_sinistres']:,}\")\n    print(f\"   Co√ªt total         : {indicateurs['cout_total']:,.0f} ‚Ç¨\")\n    print(f\"   Fr√©quence          : {indicateurs['frequence']:.4f}\")\n    print(f\"   S√©v√©rit√© moyenne   : {indicateurs['severite']:,.0f} ‚Ç¨\")\n    print(f\"   Prime pure         : {indicateurs['prime_pure']:,.0f} ‚Ç¨\")\n    print(\"\\n‚úÖ Calcul termin√© avec succ√®s !\")\n\nif __name__ == \"__main__\":\n    main()\n```\n\n## Le Dockerfile\n\n```dockerfile\n# Image de base Python 3.10\nFROM python:3.10-slim\n\n# M√©tadonn√©es\nLABEL maintainer=\"Fran√ßois Boussengui\"\nLABEL description=\"Calcul d'indicateurs de sinistralit√©\"\n\n# D√©finir le r√©pertoire de travail\nWORKDIR /app\n\n# Copier et installer les d√©pendances (pour profiter du cache Docker)\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Copier le code source\nCOPY main.py .\n\n# Commande par d√©faut\nCMD [\"python\", \"main.py\"]\n```\n\n## Build et Run\n\n:::{.terminal-box}\n<span class=\"comment\"># Construire l'image</span><br>\n<span class=\"prompt\">$</span> docker build -t sinistralite:v1 .<br>\n<span class=\"output\">[+] Building 15.3s (9/9) FINISHED</span><br>\n<span class=\"output\"> => [1/4] FROM python:3.10-slim</span><br>\n<span class=\"output\"> => [2/4] WORKDIR /app</span><br>\n<span class=\"output\"> => [3/4] COPY requirements.txt .</span><br>\n<span class=\"output\"> => [4/4] RUN pip install ...</span><br>\n<span class=\"output\"> => [5/5] COPY main.py .</span><br><br>\n<span class=\"comment\"># Lancer le conteneur</span><br>\n<span class=\"prompt\">$</span> docker run --rm sinistralite:v1<br>\n<span class=\"output\">==================================================</span><br>\n<span class=\"output\">üê≥ Script de sinistralit√© dockeris√©</span><br>\n<span class=\"output\">==================================================</span><br>\n<span class=\"output\"></span><br>\n<span class=\"output\">üìä Indicateurs calcul√©s :</span><br>\n<span class=\"output\">   Nombre de sinistres : 1,000</span><br>\n<span class=\"output\">   Co√ªt total         : 1,847,293 ‚Ç¨</span><br>\n<span class=\"output\">   Fr√©quence          : 1.3245</span><br>\n<span class=\"output\">   S√©v√©rit√© moyenne   : 1,847 ‚Ç¨</span><br>\n<span class=\"output\">   Prime pure         : 2,447 ‚Ç¨</span><br>\n<span class=\"output\"></span><br>\n<span class=\"output\">‚úÖ Calcul termin√© avec succ√®s !</span>\n:::\n\n---\n\n# Bonnes pratiques\n\n## Optimiser la taille de l'image\n\n:::{.comparison-grid}\n\n:::{.comparison-card}\n#### ‚ùå √Ä √©viter\n\n```dockerfile\nFROM python:3.10\nRUN apt-get update\nRUN apt-get install -y gcc\nRUN pip install pandas\nRUN pip install numpy\nCOPY . .\n```\n\n- Image de base lourde\n- Plusieurs RUN = plusieurs couches\n- Pas de nettoyage du cache\n:::\n\n:::{.comparison-card}\n#### ‚úÖ Recommand√©\n\n```dockerfile\nFROM python:3.10-slim\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends gcc && \\\n    rm -rf /var/lib/apt/lists/*\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\n```\n\n- Image slim (plus l√©g√®re)\n- Commandes group√©es\n- Cache nettoy√©\n:::\n\n:::\n\n## Utiliser un .dockerignore\n\nComme `.gitignore`, le fichier `.dockerignore` exclut des fichiers du contexte de build :\n\n```text\n# .dockerignore\n__pycache__/\n*.pyc\n*.pyo\n.git/\n.gitignore\n.env\n*.md\n.vscode/\n.idea/\ndata/raw/\n```\n\n:::{.concept-cle}\n**üí° Point cl√©**\n\nUn bon `.dockerignore` acc√©l√®re le build et r√©duit la taille de l'image en √©vitant de copier des fichiers inutiles.\n:::\n\n## Ne pas lancer en root\n\nPar d√©faut, les conteneurs s'ex√©cutent en tant que root. En production, c'est un risque de s√©curit√© :\n\n```dockerfile\nFROM python:3.10-slim\n\n# Cr√©er un utilisateur non-root\nRUN useradd --create-home appuser\nWORKDIR /home/appuser/app\n\n# Copier les fichiers\nCOPY --chown=appuser:appuser . .\n\n# Passer √† l'utilisateur non-root\nUSER appuser\n\n# Installer les d√©pendances pour cet utilisateur\nRUN pip install --user --no-cache-dir -r requirements.txt\n\nCMD [\"python\", \"main.py\"]\n```\n\n---\n\n# Synth√®se {.unnumbered}\n\n:::{.synthese-card}\n### üéØ Les 5 points essentiels √† retenir\n\n1. **Docker r√©sout le \"√ßa marche sur ma machine\"** ‚Äî En empaquetant ton code avec son environnement complet\n\n2. **Image ‚â† Conteneur** ‚Äî L'image est la recette, le conteneur est le plat cuisin√©\n\n3. **Le Dockerfile d√©finit l'image** ‚Äî C'est la recette √©tape par √©tape pour construire ton environnement\n\n4. **Les volumes persistent les donn√©es** ‚Äî Sans volume, les donn√©es sont perdues √† l'arr√™t du conteneur\n\n5. **L'ordre des instructions compte** ‚Äî Mets les √©l√©ments qui changent peu (d√©pendances) avant ceux qui changent souvent (code) pour profiter du cache\n:::\n\n---\n\n# Auto-√©valuation {.unnumbered}\n\n::: {.callout-note collapse=\"true\"}\n## Question 1 : Quelle est la diff√©rence entre une image et un conteneur ?\n\n**R√©ponse** : Une **image** est un template en lecture seule qui contient l'environnement (OS, d√©pendances, code). Un **conteneur** est une instance en cours d'ex√©cution de cette image. On peut cr√©er plusieurs conteneurs √† partir de la m√™me image.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Question 2 : Pourquoi copie-t-on requirements.txt avant le reste du code dans un Dockerfile ?\n\n**R√©ponse** : Pour profiter du **cache Docker**. Les d√©pendances changent rarement, alors que le code change souvent. En copiant requirements.txt d'abord et en installant les d√©pendances, cette couche sera mise en cache. Les builds suivants seront beaucoup plus rapides car seules les couches apr√®s le changement seront reconstruites.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Question 3 : Comment persister des donn√©es entre les ex√©cutions d'un conteneur ?\n\n**R√©ponse** : En utilisant un **volume**. On monte un dossier de la machine h√¥te dans le conteneur avec l'option `-v` : `docker run -v /chemin/hote:/chemin/conteneur mon-image`. Les donn√©es √©crites dans `/chemin/conteneur` seront en fait stock√©es dans `/chemin/hote` et persisteront.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Question 4 : Quelle commande permet d'entrer dans un conteneur en cours d'ex√©cution ?\n\n**R√©ponse** : `docker exec -it <container_id> bash` (ou `sh` si bash n'est pas disponible). L'option `-i` garde STDIN ouvert et `-t` alloue un pseudo-TTY pour avoir un terminal interactif.\n:::\n\n---\n\n# Ressources compl√©mentaires {.unnumbered}\n\n- **Documentation officielle** : [https://docs.docker.com](https://docs.docker.com)\n- **Docker Hub** (images publiques) : [https://hub.docker.com](https://hub.docker.com)\n- **Tutoriel interactif** : [https://www.docker.com/play-with-docker](https://www.docker.com/play-with-docker)\n- **Grafikart (FR)** : Excellents tutoriels Docker en fran√ßais sur YouTube\n\n---\n\n:::{.exemple-box}\n**üê≥ Prochaine √©tape technique**\n\n**Semaine 2** : Nous approfondirons Docker avec Docker Compose pour orchestrer plusieurs conteneurs, et nous dockeriserons ton application Streamlit de pr√©diction de prix de montres.\n:::\n\n---\n\n[‚Üê Retour √† la Semaine 1](index.html){.btn .btn-secondary}\n[Voir la Fiche de travail ‚Üí](fiche-travail-01.html){.btn .btn-primary}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}